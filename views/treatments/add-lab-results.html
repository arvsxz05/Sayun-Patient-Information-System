<!DOCTYPE html>
<html>

<head>
    <title>Add Laboratory Result</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="../../static/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../../static/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="../../static/css/styles.css">
    <link rel="stylesheet" type="text/css" href="../../static/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.15/css/dataTables.bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="../../static/css/fileinput.min.css">
    <link rel="stylesheet" type="text/css" href="../../static/css/fileinput-rtl.min.css">
    <script type="text/javascript" src="../../static/js/jquery.js"></script>
    <script type="text/javascript" src="../../static/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.15/js/dataTables.bootstrap.min.js"></script>
    <script type="text/javascript" src="../../static/js/fileinput.min.js"></script>
</head>

<body>
    <!-- NAVIGATION -->
    <nav class="navbar navbar-inverse">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>                        
          </button>
                <a class="navbar-brand" href="#">SPIS LOGO HERE</a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
                <ul class="nav navbar-nav">
                    <li class="active"><a href="#">Home</a></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="#">NAME OF USER HERE</a></li>
                    <li><a href="#"><span class="glyphicon glyphicon-log-out"></span> Log out</a></li>
                </ul>
            </div>
        </div>
    </nav>
    <!-- END OF NAVIGATION -->

    <div class="container-fluid main-container">
        <!-- BREADCRUMBS -->
        <ol class="breadcrumb">
            <li><a href="#">Home</a></li>
            <li><a href="#">Patient List</a></li>
            <li><a href="#">Patient Name</a></li>
            <li class="active">Add Laboratory Results</li>
        </ol>
        <!-- END OF BREADCRUMBS -->

        <div class="container-fluid">
            <div class="row">
                <div class="col-sm-8 col-sm-offset-2 form-container">
                    <form id="add-lab-form" class="form-horizontal" role="form" method="POST" action="/laboratory_add" enctype="multipart/form-data">
                        <br>
                        <div class="col-xs-12">
                            <div class="form-group">
                                <label class="col-sm-4 control-label" for="patient-id">Patient ID</label>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control" id="patient-id" value="247263" disabled>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-4 control-label" for="patient-id">Patient Name</label>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control" id="patient-id" value="ARVIN SALE ARBUIS" disabled>
                                </div>
                            </div>
                            <br>
                        </div>

                        <legend><b>Add Laboratory Results</b></legend>

                        <div class="col-xs-12">
                            <fieldset>
                                <div class="form-group">
                                    <label class="col-sm-4 control-label" for="date">Date*</label>
                                    <div class="col-sm-8">
                                        <input type="date" class="form-control" name="date" id="date" required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-4 control-label" for="username">Hospital/Clinic*</label>
                                    <div class="col-sm-8">
                                        <select class="form-control" id="hospital" name="hospital" required>
                                            <option value="" selected disabled>Select Hospital/Clinic</option>
                                            {% for hospital in hospitals %}
                                                <option value="{{ hospital.name }}">{{ hospital.name }}</option>
                                            {% endfor %}
                                            <option value="edc">chohjds</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-4 control-label" for="description">Description*</label>
                                    <div class="col-sm-8">
                                        <textarea class="form-control" rows="5" name="description" id="description"></textarea>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-4 control-label" for="notes">Notes</label>
                                    <div class="col-sm-8">
                                        <textarea class="form-control" rows="5" name="notes" id="notes"></textarea>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-4 control-label" for="attachments">Select File</label>
                                    <div class="col-sm-8">
                                        <input id="attachments" name="attachments[]" type="file" multiple class="file-loading">
                                    </div>
                                </div>
                                <div class="button-group">
                                    <a href="/account_list" class="btn btn-gray pull-right">Cancel</a>
                                    <button type="submit" class="btn btn-lime pull-right" id="save-btn">Save</button>
                                </div>
                            </fieldset>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</body>
<script>
    $(document).on('ready', function() {
        $("#attachments").fileinput({
            // showUpload: false,
            uploadUrl: '/upload_files_lab_results',
            browseOnZoneClick: true,
            layoutTemplates: {
                actions: '<div class="file-actions">\n' +
                '    <div class="file-footer-buttons">\n' +
                '        {delete} {zoom} {other}' +
                '    </div>\n' +
                '    {drag}\n' +
                '    <div class="clearfix"></div>\n' +
                '</div>'
            },
            uploadClass: 'btn btn-xs btn-default unique-name-hehe hidden'
        });
    });

    $( "#add-lab-form" ).submit(function( event ) {
        var files = $('#attachments').fileinput('getFileStack');
        if(files.length != 0) {
            $(".unique-name-hehe").click();
            event.preventDefault();
        }
    });

    $('#attachments').on('filebatchuploadcomplete', function(event, files, extra) {
        console.log('File batch upload complete');
        $("#add-lab-form").submit();
    });
</script>
</html>