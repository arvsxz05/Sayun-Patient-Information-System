<div class="row" id="list-opt-view">
    <div class="table-responsive">
        <h3>Out-Patient Treatment List</h3>
        <table id="opt-list" class="table table-striped table-bordered" cellspacing="0" width="100%">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Hospital</th>
                    <th>Doctor</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>

    <div class="button-group">
        <a class="btn btn-lime pull-right" type="button" onclick="add_OPT()">Add</a>    
    </div>
</div>


<script type="text/javascript">
    function edit_OPT(){
        $('#list-opt-view').hide();
        $('#add-opt-view').hide();
        $('#edit-opt-view').show();
        $('#list-opt-view-link').show();

        var key = $("#edit_opt").attr('value');
        console.log(key);
        $.ajax({
            type: "GET",
            url: "/opt_edit_json/"+key+"/"+"{{patient.id}}",
        }).done(function(data){
            console.log("IN HERE DONE OPT EDIT AJAX");
            console.log(data);
            var date;
            // $('#edit-p-id').val(key);

            if(data['opt']['date'] != null){
                date = data['opt']['date'].split("-");
                $("#edit-opt-date-div select[name='date_[month]']").val(date[1]);
                $("#edit-opt-date-div select[name='date_[day]']").val(date[2]);
                $("#edit-opt-date-div select[name='date_[year]']").val(date[0]);
            }

            $('#edit-opt-hospital option[value="' + data['opt']['parent_record.hospitalName'] + '"]').prop('selected', 'true');
            $('#edit-opt-doctor option[value="' + data['opt']['parent_record.doctor.id'] + '"]').prop('selected', 'true');

            $('#edit-opt-summary').val(data['opt']['sum_of_diag']);
            $('#edit-opt-detailed-diagnosis').val(data['opt']['detailed_diag']);
            $('#edit-opt-notes').val(data['opt']['notes']);
            $('#edit-opt-hospital option[value="' + data['opt']['hospital'] + '"]').prop('selected', 'true');

            // console.log(data);

            $('#edit-opt-form').attr('action', '/opt_edit/'+data['opt']['id']+"/"+data['opt']['parent_record.id']);
            
        });


    }

    function add_OPT() {
            $('#list-opt-view').hide();
            $('#add-opt-view').show();
            $('#edit-opt-view').hide();
            $('#list-opt-view-link').show();
        // dapat on-Submit nani sa ADD IPT Record//
        meds = $('#list-medication').DataTable({
            "bSort": true, 
            "aaSorting": [[0]],
            "aoColumns": [
                { "bSortable": false },
                { "bSortable": true },
                { "bSortable": true },
                { "bSortable": true },
                { "bSortable": true },
                { "bSortable": true }
            ]    
        });

        med_procedures = $('#list-med-procedure').DataTable({
            "bSort": true, 
            "aaSorting": [[0]],
            "aoColumns": [
                { "bSortable": false },
                { "bSortable": true },
                { "bSortable": true },
                { "bSortable": true }
            ]    
        });
        // 
    }

</script>